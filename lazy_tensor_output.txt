INFO:__main__:============================================================
INFO:__main__:LazyTensor Remote Execution Tests
INFO:__main__:============================================================
INFO:__main__:
/mnt/2_1/jaewan/jae/Genie/genie/version_validator.py:23: UserWarning: Genie targets PyTorch 2.2.x‚Äì2.5.x or 2.8+; found 2.1.2+cpu
  warnings.warn(f"Genie targets PyTorch 2.2.x‚Äì2.5.x or 2.8+; found {torch.__version__}")
INFO:genie.core.enhanced_dispatcher:Enhanced dispatcher loaded: 0/50 operations registered successfully (0.0% coverage)
INFO:genie.core.library:Phase 1 library loaded: 0 ops registered, 0 failed (impls disabled)
INFO:genie.core.device:Successfully registered remote_accelerator backend
INFO:genie.core.device:Initialized default remote_accelerator device
INFO:__main__:‚úÖ LazyTensor device set correctly: remote_accelerator:0
INFO:__main__:‚úÖ Operations stay lazy
INFO:__main__:
INFO:__main__:============================================================
INFO:__main__:üß™ Testing Remote Execution
INFO:__main__:============================================================
INFO:__main__:
INFO:__main__:IMPORTANT: Make sure server is running!
INFO:__main__:  python -m genie.runtime.simple_server
INFO:__main__:
INFO:__main__:1. Created LazyTensor: remote_accelerator:0
INFO:__main__:2. Applied relu (still lazy): materialized=False
INFO:__main__:3. Materializing (will execute remotely)...
INFO:genie.core.executor:Routing lt_5 to remote execution
INFO:genie.core.executor:üåê Remote execution: aten::relu
INFO:genie.core.executor:Routing lt_4 to remote execution
INFO:genie.core.executor:üåê Remote execution: aten::randn
INFO:genie.core.executor:Local tensor creation: randn
INFO:genie.core.executor:Routing lt_6 to remote execution
INFO:genie.core.executor:üåê Remote execution: aten::randn
INFO:genie.core.executor:Local tensor creation: randn
INFO:genie.runtime.simple_client:Created RemoteExecutionClient: http://localhost:8888
ERROR:genie.runtime.simple_client:HTTP error during remote execution: 500 Server Error: Internal Server Error for url: http://localhost:8888/execute
ERROR:genie.core.executor:‚ùå Remote execution failed: 500 Server Error: Internal Server Error for url: http://localhost:8888/execute
Traceback (most recent call last):
  File "/mnt/2_1/jaewan/jae/Genie/genie/core/executor.py", line 804, in _execute_remote
    result = client.execute(
  File "/mnt/2_1/jaewan/jae/Genie/genie/runtime/simple_client.py", line 129, in execute
    response.raise_for_status()
  File "/mnt/2_1/jaewan/jae/Genie/.venv/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8888/execute

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "tests/test_lazy_tensor_remote.py", line 122, in <module>
    test_remote_execution()
  File "tests/test_lazy_tensor_remote.py", line 76, in test_remote_execution
    result = y.materialize()
  File "/mnt/2_1/jaewan/jae/Genie/genie/core/lazy_tensor.py", line 307, in materialize
    self.concrete_value = execute_subgraph(self)
  File "/mnt/2_1/jaewan/jae/Genie/genie/core/executor.py", line 827, in execute_subgraph
    return _executor.execute_subgraph(target_lazy_tensor)
  File "/mnt/2_1/jaewan/jae/Genie/genie/core/executor.py", line 80, in execute_subgraph
    return _execute_remote(target_lazy_tensor)
  File "/mnt/2_1/jaewan/jae/Genie/genie/core/executor.py", line 815, in _execute_remote
    raise RuntimeError(
RuntimeError: Remote execution of relu failed: 500 Server Error: Internal Server Error for url: http://localhost:8888/execute
Make sure server is running: python -m genie.runtime.simple_server
